# 模反元素數學競賽遊戲

這是一個基於網頁的多人模反元素計算競賽遊戲，玩家間透過比賽，比較誰能更快地計算出模反元素。

## 玩家說明
### 遊戲規則
1. 由一位玩家負責創建房間，設定房間 ID、模式、難度、秒數等
2. 其他玩家透過「加入遊戲」進入遊戲
3. 系統會隨機生成數道問題，每道問題包含一個質數 p (11-50) 和一個數字a (0-p-1)
4. 玩家需要計算 a 在模 p 下的模反元素
5. 遊戲計分如下：
   - 在「搶快」模式下，第一個回答正確的玩家獲得分數
   - 在「比速度」模式下，會根據回答的相對時間給予分數
6. 數道題目結束後，分數高的玩家獲勝

### 積分模式
積分模式會根據您的積分匹配對手，比賽結果將影響您的積分排名。

- 遊戲難度根據雙方積分較低的玩家決定：
   - 新手、專家 (0-1599): 簡單難度，3題
   - 精通 (1600-1899): 中等難度，7題
   - 大師 (1900+): 困難難度，15題
- 所有積分賽均為搶快模式，每題30秒限時。

### 模反元素的計算方法

在模 p 的算術中，a 的模反元素是指一個數 x，使得 a·x ≡ 1 (mod p)。

幾種計算方法：

1. **暴力法**：試算 1 到 p-1 中哪個數乘以 a 後 mod p 得到 1
2. **擴展歐幾里得算法**：最有效的方法，可以計算 ax + by = gcd(a, b) 中的 x 和 y
3. **費馬小定理**：若 p 為質數且 a 與 p 互質，則 a^(p-1) ≡ 1 (mod p)，因此 a^(p-2) ≡ a^(-1) (mod p)

### 範例
例如，找出 3 在模 7 下的模反元素：
- 計算 3 × x ≡ 1 (mod 7)
- 試算：3 × 1 = 3 (mod 7) ❌
- 試算：3 × 2 = 6 (mod 7) ❌
- 試算：3 × 3 = 9 ≡ 2 (mod 7) ❌
- 試算：3 × 4 = 12 ≡ 5 (mod 7) ❌
- 試算：3 × 5 = 15 ≡ 1 (mod 7) ✓

所以 3 在模 7 下的模反元素是 5。

## 開發者說明
### 技術細節
- 後端：Python + Flask + Socket.IO + SQLite
- 前端：HTML + CSS + JavaScript + Socket.IO client
- By：Claude AI

## 安裝說明
1. 確保已安裝 Python 3.8 或更高版本
2. 安裝必要的依賴：

```bash
pip install flask flask-socketio eventlet
```

3. 下載或克隆本倉庫

```bash
git clone https://github.com/temmie-950807/modinv_game.git
```

4. 初始化資料

```bash
python init_database.py

```

如果是舊版使用 json 儲存資料，請使用

```bash
python migrate_json_to_sqlite.py
```

5. 開啟服務器：

```bash
python app.py
```

6. 在瀏覽器中打開 `http://localhost:8000`

## 故障排除
- 如果遊戲連接出現問題，請確保所有玩家能訪問服務器 IP 和端口
- 如果出現 "房間已滿" 錯誤，表示該房間已有兩名玩家
- 重啟服務器將清除所有房間數據

## 測試

```bash

python run_tests.py

# 覆蓋率報告
pytest --cov=. tests/
```